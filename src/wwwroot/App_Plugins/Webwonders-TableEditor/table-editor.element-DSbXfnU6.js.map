{"version":3,"file":"table-editor.element-DSbXfnU6.js","sources":["../../../Client/src/table-editor/table-settings-modal.token.ts","../../../Client/src/table-editor/table-create-modal.token.ts","../../../Client/src/table-editor/table-editor.element.ts"],"sourcesContent":["import { UmbModalToken } from '@umbraco-cms/backoffice/modal';\r\n\r\nexport type TableSettingsModalData = {\r\n    headline?: string;\r\n    settings: {\r\n        columnHasHeader: boolean;\r\n        rowHasHeader: boolean;\r\n        highlightEmptyCells?: boolean;\r\n    };\r\n};\r\n\r\nexport type TableSettingsModalResult = {\r\n    settings: TableSettingsModalData['settings'];\r\n};\r\n\r\nexport const TABLE_SETTINGS_MODAL_TOKEN = new UmbModalToken<TableSettingsModalData, TableSettingsModalResult>(\r\n    'Webwonders.TableEditor.TableSettingsModal',\r\n    {\r\n        modal: {\r\n            type: 'sidebar',\r\n            size: 'small',\r\n        },\r\n    }\r\n);","import { UmbModalToken } from \"@umbraco-cms/backoffice/modal\";\r\n\r\nexport type TableCreateModalData = {\r\n    headline?: string;\r\n    // Optional defaults if you ever want them:\r\n    rows?: number;\r\n    columns?: number;\r\n};\r\n\r\nexport type TableCreateModalValue = {\r\n    rows: number;\r\n    columns: number;\r\n};\r\n\r\nexport const TABLE_CREATE_MODAL_TOKEN = new UmbModalToken<TableCreateModalData, TableCreateModalValue>(\r\n    \"Webwonders.TableEditor.CreateTableModal\",\r\n    {\r\n        modal: {\r\n            type: \"dialog\",\r\n        },\r\n    }\r\n);","import {\r\n    css,\r\n    html,\r\n    LitElement,\r\n    customElement,\r\n    property,\r\n    state\r\n} from \"@umbraco-cms/backoffice/external/lit\";\r\nimport { UmbElementMixin } from \"@umbraco-cms/backoffice/element-api\";\r\nimport { UmbChangeEvent } from \"@umbraco-cms/backoffice/event\";\r\nimport { umbOpenModal } from \"@umbraco-cms/backoffice/modal\";\r\nimport { TABLE_SETTINGS_MODAL_TOKEN } from \"./table-settings-modal.token\";\r\nimport { TABLE_CREATE_MODAL_TOKEN } from \"./table-create-modal.token\";\r\n\r\ntype TableCell = { value: string };\r\ntype TableColumn = { value: string };\r\ntype RowSettings = { isHeaderRow?: boolean; isUnderlined?: boolean };\r\ntype TableRow = { cells: TableCell[]; settings: RowSettings };\r\ntype TableSettings = { columnHasHeader: boolean; rowHasHeader: boolean; highlightEmptyCells?: boolean };\r\nexport type TableModel = { settings: TableSettings; columns: TableColumn[]; rows: TableRow[] };\r\n\r\nfunction createEmptyTable(): TableModel {\r\n    return {\r\n        settings: { columnHasHeader: false, rowHasHeader: false, highlightEmptyCells: false },\r\n        columns: [],\r\n        rows: [],\r\n    };\r\n}\r\n\r\nfunction deepCopy<T>(obj: T): T {\r\n    return obj ? (JSON.parse(JSON.stringify(obj)) as T) : obj;\r\n}\r\n\r\n@customElement(\"webwonders-table-editor-property-editor-ui\")\r\nexport class WebwondersTableEditorPropertyEditorUiElement extends UmbElementMixin(LitElement) {\r\n    @property({ attribute: false })\r\n    public value?: TableModel;\r\n\r\n    @property({ type: Boolean })\r\n    public readonly?: boolean;\r\n\r\n    @state()\r\n    private _isEdit = false;\r\n\r\n    @state()\r\n    private _original?: TableModel;\r\n\r\n    @state()\r\n    private _hoverColIndex: number | null = null;\r\n\r\n    @state() private _dragRowIndex: number | null = null;\r\n    @state() private _dragOverRowIndex: number | null = null;\r\n\r\n    @state() private _dragColIndex: number | null = null;\r\n    @state() private _dragOverColIndex: number | null = null;\r\n\r\n    connectedCallback(): void {\r\n        super.connectedCallback();\r\n\r\n        const v = this.value ?? createEmptyTable();\r\n        if (!v.settings) v.settings = { columnHasHeader: false, rowHasHeader: false, highlightEmptyCells: false };\r\n        if (v.settings.highlightEmptyCells === undefined) v.settings.highlightEmptyCells = false;\r\n\r\n        this.value = v;\r\n        this._original = deepCopy(v);\r\n    }\r\n\r\n    private _commit(next: TableModel) {\r\n        this.value = next;\r\n        this.dispatchEvent(new UmbChangeEvent());\r\n    }\r\n\r\n    private _toggleEdit() {\r\n        if (this.readonly) return;\r\n        this._isEdit = !this._isEdit;\r\n        if (this._isEdit) this._original = deepCopy(this.value ?? createEmptyTable());\r\n    }\r\n\r\n    private _cancel() {\r\n        if (this.readonly) return;\r\n        this._isEdit = false;\r\n        if (this._original) this._commit(deepCopy(this._original));\r\n    }\r\n    \r\n    private async _openTableSettings() {\r\n        if (this.readonly) return;\r\n\r\n        const current = this.value ?? createEmptyTable();\r\n\r\n        const result = await umbOpenModal(this, TABLE_SETTINGS_MODAL_TOKEN, {\r\n            data: {\r\n                headline: \"Table settings\",\r\n                settings: {\r\n                    columnHasHeader: !!current.settings.columnHasHeader,\r\n                    rowHasHeader: !!current.settings.rowHasHeader,\r\n                    highlightEmptyCells: !!current.settings.highlightEmptyCells,\r\n                },\r\n            },\r\n        }).catch(() => undefined);\r\n        \r\n        if (!result?.settings) return;\r\n\r\n        const t = deepCopy(current);\r\n        t.settings = {\r\n            ...t.settings,\r\n            ...result.settings,\r\n        };\r\n\r\n        this._commit(t);\r\n    }\r\n\r\n    private _updateRowSettings(rowIndex: number, patch: Partial<RowSettings>) {\r\n        if (this.readonly) return;\r\n\r\n        const t = deepCopy(this.value ?? createEmptyTable());\r\n        const row = t.rows[rowIndex];\r\n        if (!row) return;\r\n\r\n        row.settings = {\r\n            ...(row.settings ?? {}),\r\n            ...patch,\r\n        };\r\n\r\n        this._commit(t);\r\n    }\r\n\r\n    private async _openCreateTableModal() {\r\n        if (this.readonly) return;\r\n\r\n        const result = await umbOpenModal(this, TABLE_CREATE_MODAL_TOKEN, {\r\n            data: {\r\n                headline: \"Create table\",\r\n                rows: 3,\r\n                columns: 3,\r\n            },\r\n        }).catch(() => undefined);\r\n\r\n        if (!result) return;\r\n\r\n        this._createTable(result.rows, result.columns);\r\n    }\r\n\r\n    private _createTable(rowCount: number, colCount: number) {\r\n        const cols = Array.from({ length: colCount }, () => ({ value: \"\" }));\r\n        const rows = Array.from({ length: rowCount }, () => ({\r\n            settings: {},\r\n            cells: Array.from({ length: colCount }, () => ({ value: \"\" })),\r\n        }));\r\n\r\n        const next = {\r\n            ...(this.value ?? { settings: { columnHasHeader: false, rowHasHeader: false, highlightEmptyCells: false }, columns: [], rows: [] }),\r\n            settings: {\r\n                columnHasHeader: false,\r\n                rowHasHeader: false,\r\n                highlightEmptyCells: false,\r\n            },\r\n            columns: cols,\r\n            rows,\r\n        };\r\n        \r\n        this.value = next;\r\n        this._isEdit = true;\r\n        this.dispatchEvent(new UmbChangeEvent());\r\n    }\r\n    \r\n    private _insertRow(index: number) {\r\n        if (this.readonly) return;\r\n\r\n        const t = deepCopy(this.value ?? createEmptyTable());\r\n\r\n        const newRow: TableRow = {\r\n            settings: { isHeaderRow: false, isUnderlined: false },\r\n            cells: t.columns.map(() => ({ value: \"\" })),\r\n        };\r\n\r\n        const safeIndex = Math.max(0, Math.min(index, t.rows.length));\r\n        t.rows.splice(safeIndex, 0, newRow);\r\n\r\n        this._commit(t);\r\n    }\r\n\r\n    private _insertCol(index: number) {\r\n        if (this.readonly) return;\r\n\r\n        const t = deepCopy(this.value ?? createEmptyTable());\r\n\r\n        const safeIndex = Math.max(0, Math.min(index, t.columns.length));\r\n        \r\n        t.columns.splice(safeIndex, 0, { value: \"\" });\r\n        \r\n        for (const row of t.rows) {\r\n            row.cells.splice(safeIndex, 0, { value: \"\" });\r\n        }\r\n\r\n        this._commit(t);\r\n    }\r\n\r\n    private _removeCol(index: number) {\r\n        if (this.readonly) return;\r\n        const t = deepCopy(this.value ?? createEmptyTable());\r\n        if (t.columns.length <= 1) return;\r\n        if (index < 0 || index >= t.columns.length) return;\r\n\r\n        t.columns.splice(index, 1);\r\n        for (const row of t.rows) row.cells.splice(index, 1);\r\n        this._commit(t);\r\n    }\r\n\r\n    private _removeRow(index: number) {\r\n        if (this.readonly) return;\r\n        const t = deepCopy(this.value ?? createEmptyTable());\r\n        if(t.rows.length <= 1) return;\r\n        if (index < 0 || index >= t.rows.length) return;\r\n        t.rows.splice(index, 1);\r\n        this._commit(t);\r\n    }\r\n\r\n    private _updateColName(index: number, value: string) {\r\n        const t = deepCopy(this.value ?? createEmptyTable());\r\n        if (!t.columns[index]) return;\r\n        t.columns[index].value = value;\r\n        this._commit(t);\r\n    }\r\n\r\n    private _updateCell(rowIndex: number, colIndex: number, value: string) {\r\n        const t = deepCopy(this.value ?? createEmptyTable());\r\n        const row = t.rows[rowIndex];\r\n        if (!row?.cells[colIndex]) return;\r\n        row.cells[colIndex].value = value;\r\n        this._commit(t);\r\n    }\r\n\r\n    private _isTableEmpty(table: TableModel | undefined) {\r\n        if (!table) return true;\r\n        return table.columns.length === 0 && table.rows.length === 0;\r\n    }\r\n\r\n    private _moveRow(from: number, to: number) {\r\n        if (from === to) return;\r\n\r\n        const t = deepCopy(this.value ?? createEmptyTable());\r\n        if (from < 0 || from >= t.rows.length) return;\r\n\r\n        // clamp \"to\" to valid insertion points (0..len-1)\r\n        const clampedTo = Math.max(0, Math.min(to, t.rows.length - 1));\r\n\r\n        const [row] = t.rows.splice(from, 1);\r\n        t.rows.splice(clampedTo, 0, row);\r\n\r\n        this._commit(t);\r\n    }\r\n\r\n    private _moveCol(from: number, to: number) {\r\n        if (from === to) return;\r\n\r\n        const t = deepCopy(this.value ?? createEmptyTable());\r\n        if (from < 0 || from >= t.columns.length) return;\r\n\r\n        const clampedTo = Math.max(0, Math.min(to, t.columns.length - 1));\r\n\r\n        const [col] = t.columns.splice(from, 1);\r\n        t.columns.splice(clampedTo, 0, col);\r\n\r\n        for (const row of t.rows) {\r\n            const [cell] = row.cells.splice(from, 1);\r\n            row.cells.splice(clampedTo, 0, cell);\r\n        }\r\n\r\n        this._commit(t);\r\n    }\r\n\r\n    private _onRowDragStart(e: DragEvent, rowIndex: number) {\r\n        if (this.readonly) return;\r\n        this._dragRowIndex = rowIndex;\r\n        this._dragOverRowIndex = rowIndex;\r\n\r\n        e.dataTransfer?.setData(\"text/plain\", String(rowIndex));\r\n        e.dataTransfer?.setData(\"application/x-webwonders-row\", \"1\");\r\n        e.dataTransfer?.setDragImage?.((e.target as HTMLElement), 10, 10);\r\n        if (e.dataTransfer) e.dataTransfer.effectAllowed = \"move\";\r\n    }\r\n\r\n    private _onRowDragOver(e: DragEvent, rowIndex: number) {\r\n        // allow drop\r\n        if (!this._isDraggingRow(e)) return;\r\n        e.preventDefault();\r\n        this._dragOverRowIndex = rowIndex;\r\n        if (e.dataTransfer) e.dataTransfer.dropEffect = \"move\";\r\n    }\r\n\r\n    private _onRowDrop(e: DragEvent, rowIndex: number) {\r\n        if (!this._isDraggingRow(e)) return;\r\n        e.preventDefault();\r\n\r\n        const from = this._dragRowIndex;\r\n        this._clearRowDrag();\r\n\r\n        if (from === null) return;\r\n        this._moveRow(from, rowIndex);\r\n    }\r\n\r\n    private _onRowDragEnd() {\r\n        this._clearRowDrag();\r\n    }\r\n\r\n    private _clearRowDrag() {\r\n        this._dragRowIndex = null;\r\n        this._dragOverRowIndex = null;\r\n    }\r\n\r\n    private _isDraggingRow(e: DragEvent) {\r\n        return this._dragRowIndex !== null && e.dataTransfer?.types?.includes(\"application/x-webwonders-row\");\r\n    }\r\n\r\n    private _closePopoverFromEvent(e: Event) {\r\n        const el = e.currentTarget as HTMLElement | null;\r\n        const popover = el?.closest(\"uui-popover-container\") as any;\r\n        if (!popover) return;\r\n\r\n        // UUI / Popover API variants:\r\n        if (typeof popover.hidePopover === \"function\") popover.hidePopover();\r\n        else if (typeof popover.close === \"function\") popover.close();\r\n        else if (\"open\" in popover) popover.open = false;\r\n    }\r\n\r\n// --- columns ---\r\n    private _onColDragStart(e: DragEvent, colIndex: number) {\r\n        if (this.readonly) return;\r\n        this._dragColIndex = colIndex;\r\n        this._dragOverColIndex = colIndex;\r\n\r\n        e.dataTransfer?.setData(\"text/plain\", String(colIndex));\r\n        e.dataTransfer?.setData(\"application/x-webwonders-col\", \"1\");\r\n        e.dataTransfer?.setDragImage?.((e.target as HTMLElement), 10, 10);\r\n        if (e.dataTransfer) e.dataTransfer.effectAllowed = \"move\";\r\n    }\r\n\r\n    private _onColDragOver(e: DragEvent, colIndex: number) {\r\n        if (!this._isDraggingCol(e)) return;\r\n        e.preventDefault();\r\n        this._dragOverColIndex = colIndex;\r\n        if (e.dataTransfer) e.dataTransfer.dropEffect = \"move\";\r\n    }\r\n\r\n    private _onColDrop(e: DragEvent, colIndex: number) {\r\n        if (!this._isDraggingCol(e)) return;\r\n        e.preventDefault();\r\n\r\n        const from = this._dragColIndex;\r\n        this._clearColDrag();\r\n\r\n        if (from === null) return;\r\n        this._moveCol(from, colIndex);\r\n    }\r\n\r\n    private _onColDragEnd() {\r\n        this._clearColDrag();\r\n    }\r\n\r\n    private _clearColDrag() {\r\n        this._dragColIndex = null;\r\n        this._dragOverColIndex = null;\r\n    }\r\n\r\n    private _isDraggingCol(e: DragEvent) {\r\n        return this._dragColIndex !== null && e.dataTransfer?.types?.includes(\"application/x-webwonders-col\");\r\n    }\r\n\r\n    override render() {\r\n        const table = this.value ?? createEmptyTable();\r\n\r\n        return html`\r\n            ${this._isEdit\r\n            ? html`\r\n                    ${this._renderEditControls(table)}\r\n                    ${this._renderEditTable(table)}\r\n                `\r\n            : html`${this._renderReadTable(table)}`}\r\n\r\n            ${this._renderToolbar()}\r\n        `;\r\n    }\r\n\r\n    private _renderToolbar() {\r\n        const table = this.value;\r\n        const isEmpty = this._isTableEmpty(table);\r\n\r\n        return html`\r\n            <div class=\"toolbar\">\r\n                ${!this._isEdit && isEmpty\r\n                        ? html`\r\n                    <uui-button\r\n                        look=\"primary\"\r\n                        label=\"Create table\"\r\n                        ?disabled=${this.readonly}\r\n                        @click=${this._openCreateTableModal}>\r\n                        Create\r\n                    </uui-button>\r\n                `\r\n                        : html`\r\n                    <uui-button\r\n                        look=\"primary\"\r\n                        label=${this._isEdit ? \"Done\" : \"Edit\"}\r\n                        ?disabled=${this.readonly}\r\n                        @click=${this._toggleEdit}>\r\n                        ${this._isEdit ? \"Done\" : \"Edit\"}\r\n                    </uui-button>\r\n                `\r\n                }\r\n\r\n                ${this._isEdit\r\n            ? html`\r\n                        <uui-button\r\n                                look=\"secondary\"\r\n                                @click=${this._cancel}\r\n                                .disabled=${this.readonly}\r\n                                label=\"Cancel\"></uui-button>\r\n                    `\r\n            : null}\r\n            </div>\r\n        `;\r\n    }\r\n\r\n    private _renderEditControls(_table: TableModel) {\r\n        return html`\r\n            <div class=\"editControls\">\r\n                <div class=\"settings\">\r\n                    <uui-button\r\n                            look=\"secondary\"\r\n                            compact\r\n                            @click=${this._openTableSettings}\r\n                            .disabled=${this.readonly}\r\n                            label=\"Table settings\">\r\n                        <uui-icon name=\"icon-settings\"></uui-icon>\r\n                    </uui-button>\r\n                </div>\r\n            </div>\r\n        `;\r\n    }\r\n\r\n    private _renderReadTable(table: TableModel) {\r\n        return html`\r\n            <uui-table class=\"uuiReadTable\">\r\n                <uui-table-row>\r\n                    ${table.columns.map(\r\n                            (c) => html`\r\n                            <uui-table-head-cell class=${table.settings.columnHasHeader ? \"colHeader\" : \"\"}>\r\n                                ${c.value}\r\n                            </uui-table-head-cell>\r\n                        `\r\n                    )}\r\n                </uui-table-row>\r\n\r\n                ${table.rows.map(\r\n                        (r) => html`\r\n                        <uui-table-row\r\n                                class=${[r.settings?.isHeaderRow ? \"isHeaderRow\" : \"\", r.settings?.isUnderlined ? \"isUnderlined\" : \"\"]\r\n                                .filter(Boolean)\r\n                                .join(\" \")}>\r\n                            ${r.cells.map((cell, ci) => {\r\n                            const isEmpty = !cell.value?.trim();\r\n                            return html`\r\n                                    <uui-table-cell\r\n                                            class=${[\r\n                                table.settings.rowHasHeader && ci === 0 ? \"rowHeader\" : \"\",\r\n                                table.settings.highlightEmptyCells && isEmpty ? \"empty\" : \"\",\r\n                            ]\r\n                                    .filter(Boolean)\r\n                                    .join(\" \")}>\r\n                                        ${cell.value}\r\n                                    </uui-table-cell>\r\n                                `;\r\n                        })}\r\n                        </uui-table-row>\r\n                    `\r\n                )}\r\n            </uui-table>\r\n        `;\r\n    }\r\n\r\n    private _renderEditTable(table: TableModel) {\r\n        const colCount = table.columns.length;\r\n        const templateCols = `repeat(${Math.max(colCount, 1)}, minmax(140px, 1fr))`;\r\n\r\n        return html`\r\n            <div class=\"gridEditor\" style=${`--te-cols:${templateCols};`}\r\n            data-hover-col=\"${this._hoverColIndex ?? ''}\"\r\n            data-drag-col=\"${this._dragOverColIndex ?? ''}\">\r\n                ${this._renderColumnHoverCss(table.columns.length)}\r\n                <!-- Header -->\r\n                <div class=\"headerLayout\">\r\n                    <div class=\"headerColumns\">\r\n                        ${table.columns.map((c, ci) => html`\r\n                            <div class=${[\"headerCol\", this._dragOverColIndex === ci ? \"dropTarget\" : \"\"].filter(Boolean).join(\" \")} \r\n                                 style=${`grid-column:${ci + 1};`} \r\n                                 data-col=\"${ci}\"\r\n                                 @dragover=${(e: DragEvent) => this._onColDragOver(e, ci)}\r\n                                 @drop=${(e: DragEvent) => this._onColDrop(e, ci)}\r\n                                 @mouseenter=${() => (this._hoverColIndex = ci)}\r\n                                 @mouseleave=${() => (this._hoverColIndex = null)}>\r\n                                <div class=\"colRailCell\">\r\n                                    <uui-action-bar class=\"colRailActions\">\r\n                                        <uui-button\r\n                                                label=\"Insert column before\"\r\n                                                look=\"primary\"\r\n                                                compact\r\n                                                ?disabled=${this.readonly}\r\n                                                @click=${(ev: Event) => { ev.stopPropagation(); this._insertCol(ci); }}>\r\n                                            <uui-icon name=\"icon-arrow-left\"></uui-icon>\r\n                                        </uui-button>\r\n                                        <uui-button\r\n                                                label=\"Delete column\"\r\n                                                look=\"primary\"\r\n                                                compact\r\n                                                ?disabled=${this.readonly || table.columns.length <= 1}\r\n                                                @click=${(ev: Event) => { ev.stopPropagation(); this._removeCol(ci); }}>\r\n                                            <uui-icon name=\"icon-trash\"></uui-icon>\r\n                                        </uui-button>\r\n                                        <uui-button\r\n                                                label=\"Insert column after\"\r\n                                                look=\"primary\"\r\n                                                compact\r\n                                                ?disabled=${this.readonly}\r\n                                                @click=${(ev: Event) => { ev.stopPropagation(); this._insertCol(ci + 1); }}>\r\n                                            <uui-icon name=\"icon-arrow-right\"></uui-icon>\r\n                                        </uui-button>\r\n                                        <uui-button\r\n                                                class=\"dragHandle\"\r\n                                                label=\"Drag to reorder column\"\r\n                                                look=\"secondary\"\r\n                                                compact\r\n                                                ?disabled=${this.readonly}\r\n                                                draggable=\"true\"\r\n                                                @dragstart=${(e: DragEvent) => this._onColDragStart(e, ci)}\r\n                                                @dragend=${this._onColDragEnd}>\r\n                                            <uui-icon name=\"icon-navigation\"></uui-icon>\r\n                                        </uui-button>\r\n                                    </uui-action-bar>\r\n                                </div>\r\n\r\n                                <div class=\"colHead\">\r\n                                    <uui-input\r\n                                            .value=${c.value}\r\n                                            @input=${(e: InputEvent) => this._updateColName(ci, (e.target as HTMLInputElement).value)}>\r\n                                    </uui-input>\r\n                                </div>\r\n                            </div>\r\n                        `)}\r\n                    </div>\r\n\r\n                    <div class=\"headerGutter\" aria-hidden=\"true\"></div>\r\n                </div>\r\n                \r\n                <div class=\"insertLine insertTop\">\r\n                    <uui-button-inline-create\r\n                            label=\"Add row\"\r\n                            .disabled=${this.readonly}\r\n                            @click=${() => this._insertRow(0)}></uui-button-inline-create>\r\n                </div>\r\n                \r\n                ${table.rows.map(\r\n                        (r, ri) => html`\r\n                            <div class=${[\"rowLayout\", this._dragOverRowIndex === ri ? \"dropTarget\" : \"\"].filter(Boolean).join(\" \")}\r\n                                 @dragover=${(e: DragEvent) => this._onRowDragOver(e, ri)}\r\n                                 @drop=${(e: DragEvent) => this._onRowDrop(e, ri)} \r\n                                 data-row=${ri}>\r\n                                <div class=\"gridRow\">\r\n                                    ${r.cells.map(\r\n                                            (cell, ci) => html`\r\n                                        <div\r\n                                            class=${[\r\n                                                \"cell\",\r\n                                                table.settings.rowHasHeader && ci === 0 ? \"rowHeader\" : \"\",\r\n                                                table.settings.highlightEmptyCells && !cell.value?.trim() ? \"empty\" : \"\",\r\n                                                r.settings?.isHeaderRow ? \"isHeaderRow\" : \"\",\r\n                                                r.settings?.isUnderlined ? \"isUnderlined\" : \"\",\r\n                                            ]\r\n                                                    .filter(Boolean)\r\n                                                    .join(\" \")}\r\n                                            style=${`grid-column:${ci + 1};`}\r\n                                            data-col=\"${ci}\">\r\n                                            <uui-input\r\n                                                .value=${cell.value}\r\n                                                @input=${(e: InputEvent) => this._updateCell(ri, ci, (e.target as HTMLInputElement).value)}></uui-input>\r\n                                        </div>\r\n                                    `\r\n                                    )}\r\n                                </div>\r\n\r\n                                <div class=\"rowActionsRail\">\r\n                                    <uui-action-bar class=\"rowActions\">\r\n                                        <uui-button popovertarget=\"rowSettingsMenu${ri}\"\r\n                                        look=\"secondary\"\r\n                                        label=\"Row settings\"\r\n                                        compact>\r\n                                            <uui-symbol-more></uui-symbol-more>\r\n                                        </uui-button>\r\n                                        <uui-popover-container id=\"rowSettingsMenu${ri}\" placement=\"top-left\" interaction=\"click\">\r\n                                            <uui-box class=\"rowMenu\" @click=${(ev: Event) => ev.stopPropagation()}>\r\n                                                <div class=\"rowMenuItem\">\r\n                                                    <span>Header row</span>\r\n                                                    <uui-toggle\r\n                                                            ?checked=${!!r.settings?.isHeaderRow}\r\n                                                            ?disabled=${this.readonly}\r\n                                                            @change=${(e: Event) =>\r\n                                                                    this._updateRowSettings(ri, { isHeaderRow: (e.target as any).checked })}>\r\n                                                    </uui-toggle>\r\n                                                </div>\r\n\r\n                                                <div class=\"rowMenuItem\">\r\n                                                    <span>Underlined</span>\r\n                                                    <uui-toggle\r\n                                                            ?checked=${!!r.settings?.isUnderlined}\r\n                                                            ?disabled=${this.readonly}\r\n                                                            @change=${(e: Event) =>\r\n                                                                    this._updateRowSettings(ri, { isUnderlined: (e.target as any).checked })}>\r\n                                                    </uui-toggle>\r\n                                                </div>\r\n\r\n                                                <div class=\"rowMenuDivider\"></div>\r\n                                                <div class=\"rowMenuActions\">\r\n                                                    <uui-button\r\n                                                            label=\"Delete row\"\r\n                                                            look=\"primary\"\r\n                                                            color=\"danger\"\r\n                                                            ?disabled=${this.readonly || table.rows.length <= 1}\r\n                                                            popovertargetaction=\"hide\"\r\n                                                            @click=${(ev: Event) => { ev.stopPropagation();this._closePopoverFromEvent(ev); this._removeRow(ri);}}>\r\n                                                        <uui-icon name=\"icon-trash\"></uui-icon>\r\n                                                    </uui-button>\r\n                                                    <uui-button\r\n                                                            look=\"primary\"\r\n                                                            @click=${(ev: Event) => {\r\n                                                                ev.stopPropagation();\r\n                                                                this._closePopoverFromEvent(ev);\r\n                                                            }}>\r\n                                                        Done\r\n                                                    </uui-button>\r\n                                                </div>\r\n                                            </uui-box>\r\n                                        </uui-popover-container>\r\n                                        <uui-button\r\n                                                class=\"dragHandle\"\r\n                                                label=\"Drag to reorder row\"\r\n                                                look=\"secondary\"\r\n                                                compact\r\n                                                ?disabled=${this.readonly}\r\n                                                draggable=\"true\"\r\n                                                @dragstart=${(e: DragEvent) => this._onRowDragStart(e, ri)}\r\n                                                @dragend=${this._onRowDragEnd}>\r\n                                            <uui-icon name=\"icon-navigation\"></uui-icon>\r\n                                        </uui-button>\r\n                                    </uui-action-bar>\r\n                                </div>\r\n                            </div>\r\n                            \r\n                            <div class=\"insertLine\" style=${`--afterRow:${ri};`}>\r\n                                <uui-button-inline-create\r\n                                        label=\"Add row\"\r\n                                        .disabled=${this.readonly}\r\n                                        @click=${() => this._insertRow(ri + 1)}></uui-button-inline-create>\r\n                            </div>\r\n                        `\r\n                )}\r\n            </div>\r\n        `;\r\n    }\r\n\r\n    private _renderColumnHoverCss(colCount: number) {\r\n        const rules: string[] = [];\r\n\r\n        for (let i = 0; i < colCount; i++) {\r\n            rules.push(`\r\n      .gridEditor[data-hover-col=\"${i}\"] .cell[data-col=\"${i}\"],\r\n      .gridEditor[data-hover-col=\"${i}\"] .headerCol[data-col=\"${i}\"] {\r\n        background-color: var(--uui-color-surface-alt);\r\n        border-radius: var(--uui-border-radius);\r\n      }\r\n\r\n      .gridEditor[data-drag-col=\"${i}\"] .cell[data-col=\"${i}\"],\r\n      .gridEditor[data-drag-col=\"${i}\"] .headerCol[data-col=\"${i}\"] {\r\n        border-left: 2px solid var(--uui-color-border-emphasis, var(--uui-color-border));\r\n        border-right: 2px solid var(--uui-color-border-emphasis, var(--uui-color-border));\r\n        border-radius: var(--uui-border-radius);\r\n      }\r\n    `);\r\n        }\r\n\r\n        return html`<style>${rules.join(\"\\n\")}</style>`;\r\n    }\r\n\r\n    static styles = css`\r\n        .toolbar,\r\n        .actions {\r\n            display: flex;\r\n            gap: 10px;\r\n            margin-bottom: 10px;\r\n        }\r\n\r\n        .editControls {\r\n            display: flex;\r\n            align-items: center;\r\n            justify-content: flex-end;\r\n            gap: 10px;\r\n            margin: 10px 0;\r\n        }\r\n\r\n        uui-input {\r\n            width: 100%;\r\n        }\r\n        \r\n        .gridEditor {\r\n            display: flex;\r\n            flex-direction: column;\r\n            gap: 0;\r\n            padding-bottom: var(--uui-size-6);\r\n            overflow: hidden;\r\n            background: var(--uui-color-surface);\r\n        }\r\n\r\n        .gridHeader {\r\n            display: grid;\r\n            grid-template-columns: var(--te-cols);\r\n            gap: var(--uui-size-6);\r\n            padding: 0;\r\n            border-bottom: none;\r\n            min-width: 0;\r\n        }\r\n\r\n        .headerGutter {\r\n            width: 84px;\r\n        }\r\n\r\n        .colHead {\r\n            position: relative;\r\n            display: flex;\r\n            gap: var(--uui-size-2);\r\n            align-items: center;\r\n            min-width: 0;\r\n        }\r\n        \r\n        .rowLayout {\r\n            display: grid;\r\n            grid-template-columns: 1fr 84px;\r\n            gap: var(--uui-size-2);\r\n            align-items: center;\r\n            border-bottom: 1px solid var(--uui-color-border);\r\n            transition: background-color 120ms ease-in-out;\r\n        }\r\n\r\n        .rowLayout:hover,\r\n        .rowLayout:focus-within {\r\n            background-color: var(--uui-color-surface-alt);\r\n            border-radius: var(--uui-border-radius);\r\n        }\r\n\r\n        .gridRow {\r\n            display: grid;\r\n            grid-template-columns: var(--te-cols);\r\n            gap: var(--uui-size-6);\r\n            padding: 0;\r\n            border-bottom: none;\r\n            min-width: 0;\r\n        }\r\n\r\n        .rowActionsRail {\r\n            display: flex;\r\n            justify-content: flex-start;\r\n            align-items: center;\r\n        }\r\n\r\n        .rowActionsRail .rowActions {\r\n            opacity: 0;\r\n            pointer-events: none;\r\n            transition: opacity 120ms ease-in-out;\r\n        }\r\n\r\n        .rowLayout:hover .rowActionsRail .rowActions,\r\n        .rowLayout:focus-within .rowActionsRail .rowActions {\r\n            opacity: 1;\r\n            pointer-events: auto;\r\n        }\r\n\r\n        .cell {\r\n            min-width: 0;\r\n        }\r\n\r\n        .rowHeader {\r\n            font-weight: 700;\r\n            background: var(--uui-color-surface-alt);\r\n            border-radius: 2px;\r\n            padding: 2px;\r\n        }\r\n\r\n        .isHeaderRow {\r\n            font-weight: 700;\r\n        }\r\n\r\n        .isUnderlined {\r\n            text-decoration: underline;\r\n        }\r\n\r\n        .empty uui-input {\r\n            outline: 1px dashed var(--uui-color-border);\r\n            outline-offset: 2px;\r\n        }\r\n        \r\n        .insertLine {\r\n            position: relative;\r\n            height: 0;\r\n        }\r\n\r\n        .insertLine uui-button-inline-create {\r\n            position: absolute;\r\n            left: 0;\r\n            right: 0;\r\n            top: 0px;\r\n            opacity: 0;\r\n            pointer-events: auto;\r\n            transition: opacity 120ms ease-in-out;\r\n            z-index: 5;\r\n        }\r\n\r\n        .insertLine:hover uui-button-inline-create,\r\n        .insertLine:focus-within uui-button-inline-create {\r\n            opacity: 1;\r\n        }\r\n\r\n        .insertLine::before {\r\n            content: \"\";\r\n            position: absolute;\r\n            left: 0;\r\n            right: 0;\r\n            top: -10px;\r\n            height: 20px;\r\n        }\r\n\r\n        .headerLayout {\r\n            display: grid;\r\n            grid-template-columns: 1fr 84px;\r\n            gap: var(--uui-size-2);\r\n            align-items: start;\r\n            border-bottom: 1px solid var(--uui-color-border);\r\n        }\r\n\r\n        .headerColumns {\r\n            display: grid;\r\n            grid-template-columns: var(--te-cols);\r\n            gap: var(--uui-size-6);\r\n            min-width: 0;\r\n        }\r\n        \r\n        .headerCol {\r\n            display: flex;\r\n            flex-direction: column;\r\n            gap: var(--uui-size-2);\r\n            padding: var(--uui-size-2) var(--uui-size-6) var(--uui-size-6) var(--uui-size-6);\r\n            min-width: 0;\r\n        }\r\n\r\n        .colRailCell {\r\n            display: flex;\r\n            justify-content: center;\r\n            align-items: center;\r\n            height: 30px;\r\n        }\r\n        \r\n        .colRailActions {\r\n            opacity: 0;\r\n            pointer-events: none;\r\n            transition: opacity 120ms ease-in-out;\r\n        }\r\n        \r\n        .headerCol:hover .colRailActions,\r\n        .headerCol:focus-within .colRailActions {\r\n            opacity: 1;\r\n            pointer-events: auto;\r\n        }\r\n\r\n        .headerCol {\r\n            transition: background-color 120ms ease-in-out;\r\n        }\r\n        \r\n        .cell {\r\n            padding: var(--uui-size-6);\r\n            transition: background-color 120ms ease-in-out;\r\n        }\r\n        \r\n        .colHead {\r\n            min-width: 0;\r\n        }\r\n\r\n        .dragHandle {\r\n            cursor: grab;\r\n        }\r\n\r\n        .dragHandle:active {\r\n            cursor: grabbing;\r\n        }\r\n\r\n        /* Highlight drop target (row or column) */\r\n        .dropTarget {\r\n            border: 2px solid var(--uui-palette-malibu-light, var(--uui-palette-malibu-light));\r\n            outline-offset: 2px;\r\n            border-radius: var(--uui-border-radius);\r\n        }\r\n\r\n        .rowMenu {\r\n            padding: var(--uui-size-4);\r\n            min-width: 200px;\r\n        }\r\n\r\n        .rowMenuItem {\r\n            display: flex;\r\n            align-items: center;\r\n            justify-content: space-between;\r\n            margin:8px 0;\r\n            gap: var(--uui-size-6);\r\n        }\r\n\r\n        .rowMenuDivider {\r\n            height: 1px;\r\n            background: var(--uui-color-border);\r\n            margin: var(--uui-size-2) 0;\r\n        }\r\n        \r\n        .rowMenuActions {\r\n            margin-top:8px;\r\n            display:flex;\r\n            flex-direction:row;\r\n            justify-content: space-between;\r\n        }\r\n    `;\r\n}\r\n\r\nexport { WebwondersTableEditorPropertyEditorUiElement as element };\r\n"],"names":["TABLE_SETTINGS_MODAL_TOKEN","UmbModalToken","TABLE_CREATE_MODAL_TOKEN","createEmptyTable","deepCopy","obj","WebwondersTableEditorPropertyEditorUiElement","UmbElementMixin","LitElement","v","next","UmbChangeEvent","current","result","umbOpenModal","t","rowIndex","patch","row","rowCount","colCount","cols","rows","index","newRow","safeIndex","value","colIndex","table","from","to","clampedTo","col","cell","popover","html","isEmpty","_table","c","r","ci","templateCols","e","ev","ri","rules","css","__decorateClass","property","state","customElement"],"mappings":"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"}